<section class="admin-layout__layout--single-col">
    <div class="admin-layout__card">
        <h2 class="admin-layout__card--title">Edit channel</h2>
        <form [formGroup]="form" (ngSubmit)="save()" class="admin-layout__layout--double-col" #top>

            <div class="admin-layout__card">
                <label>Channel: </label>
                <input formControlName="channel" class="admin-layout__card--form-input">
                <div *ngFor="let validation of form_validation_messages.channel" class="admin-layout__card--form-error">
                    <div *ngIf="form.get('channel').hasError(validation.type)">
                        {{validation.message}}
                    </div>
                </div>
                <div>
                    <a (click)="addPath()">
                        <input class="button succes" type="button" value="Add slide">
                    </a>
                </div>
                <div>
                    <button class="button primary" type="submit" [disabled]="!form.valid">Save</button>
                    <!--(click)="reloadPage()"-->
                    &nbsp;
                    <button class="button danger" type="button danger" (click)="revert()" [disabled]="form.pristine">undo/reload</button>
                </div>
            </div>
            <div formArrayName="path" class="admin-layout__layout--triple-col" [sortablejs]="path">
                <div *ngFor="let paths of path.controls; let i=index" [formGroupName]="i" class="admin-layout__card" >
                    <!-- path template -->
                    <h4>slide #{{i + 1}}</h4>
                    <div>

                        <div class="admin-layout__card--form-group">
                            <label>Slide url:
                                <span class="admin-layout__card--form-tooltip">
                                    &#9432;
                                    <div class="admin-layout__card--form-tooltiptext">
                                        the current paths relative url to the selected component
                                    </div>
                                </span>
                            </label><br>
                            
                            <input type="text" formControlName="pathurl" class="admin-layout__card--form-input-test" [value]="form.get('path').controls[i].get('pathurl').value">
                            <select formControlName="pathurl" >
                                <option style="display:none" >select a category</option>
                                <option *ngFor="let item of components"
                               (click)="form.path[i].controls.patchValue({ pathurl: item.url, componentName:item.name},
                               {onlySelf: true, emitEvent: true, emitModelToViewChange: true,
                                 emitViewToModelChange: true})" [value]="item.url" >{{item.name}}</option>
                            </select>
                            <button (click)="testUrl(form.get('path').controls[i].get('pathurl').value)">test</button>
                            <div *ngFor="let validation of form_validation_messages.pathUrl" class="admin-layout__card--form-error">
                                <div *ngIf="form.get('path').controls[i].get('pathurl').hasError(validation.type)">
                                    {{validation.message}}
                                </div>
                            </div>

                        </div>

                        <div class="admin-wrapper-main__card--form-group">
                            <label>Name:
                                <span class="admin-layout__card--form-tooltip">
                                    &#9432;
                                    <div class="admin-layout__card--form-tooltiptext">
                                        custom set name
                                    </div>
                                </span>
                            </label>
                            <input type="text" formControlName="componentName" class="admin-layout__card--form-input" [value]="form.get('path').controls[i].get('componentName').value">
                            <div *ngFor="let validation of form_validation_messages.componentName" class="admin-layout__card--form-error">
                                <div *ngIf="form.get('path').controls[i].get('componentName').hasError(validation.type)">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>
                        <div class="admin-layout__card--form-group">
                            <label>Description:
                                <span class="admin-layout__card--form-tooltip">
                                    &#9432;
                                    <div class="admin-layout__card--form-tooltiptext">
                                        a description of what the component does
                                    </div>
                                </span>
                            </label>
                            <textarea formControlName="description" class="admin-layout__card--form-input" [value]="form.get('path').controls[i].get('description').value"></textarea>
                            <div *ngFor="let validation of form_validation_messages.description" class="admin-layout__card--form-error">
                                <div *ngIf="form.get('path').controls[i].get('description').hasError(validation.type)">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>
                        <div class="admin-layout__card--form-group">
                            <label>Delay:
                                <span class="admin-layout__card--form-tooltip">
                                    &#9432;
                                    <div class="admin-layout__card--form-tooltiptext">
                                        time it takes in ticks to move to the next path
                                    </div>
                                </span>
                            </label>
                            <input #delay type="number" formControlName="delay" class="admin-layout__card--form-input">
                            <div *ngFor="let validation of form_validation_messages.delay" class="admin-layout__card--form-error">
                                <div *ngIf="form.get('path').controls[i].get('delay').hasError(validation.type)">
                                    {{validation.message}}
                                </div>
                            </div>
                        </div>
                        <div class="admin-layout--form-group" formGroupName="show">
                            
                            <label>show:</label>
                            <div>
                                <input type="checkbox" checked="true" formControlName="allways" id=""> show allways
                                <div *ngIf="!form.get('path').controls[i].get('show.allways').value">
                                    or between <input type="time" formControlName="timefrom" id="">and <input type="time" formControlName="timetill" id="">
                                    <div formGroupName="days">
                                        <input type="checkbox" checked="true" formControlName="monday" id=""> monday
                                        <input type="checkbox" checked="true" formControlName="tuesday" id=""> tuesday
                                        <input type="checkbox" checked="true" formControlName="wednesday" id=""> wednesday
                                        <input type="checkbox" checked="true" formControlName="thursday" id=""> thursday
                                        <input type="checkbox" checked="true" formControlName="friday" id=""> friday
                                        <input type="checkbox" checked="true" formControlName="saturday" id=""> saturday
                                        <input type="checkbox" checked="true" formControlName="sunday" id=""> sunday
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    <br>
                    <button class="button succes" type="submit" (click)="addPath()">Add slide</button> &nbsp;
                    <button class="button danger" type="button danger" (click)="removePath(i)">Remove slide</button>
                    <br>
                    <!-- End path template -->
                </div>
                
            </div>
        </form>
    </div>
    <!-- listing component gives information on how to use the routes-->
    <app-listing-components></app-listing-components>
</section>